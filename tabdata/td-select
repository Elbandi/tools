#!/usr/bin/env perl

$HelpText = <<'END';
USAGE
  td-select <COLUMN-1> [<COLUMN-2> [...]]
SYNOPSIS
  Show only the specified columns from the input tabular data stream.
END

do '/usr/lib/tool/perl5/tabdata/common.pl' or die "$@";

@Columns = ();

while($arg = shift @ARGV)
{
	if($arg =~ /^([^-].*)$/)
	{
		push @Columns, $1;
	}
	else
	{
		die "$0: unknown option: $arg\n";
	}
}

process_header(scalar <STDIN>);

# display selected headers
unless($OptNoHeader)
{
	@Output = ();
	for my $col (@Columns)
	{
		push @Output, defined $Header{$col} ? $Header[$Header{$col}] : '';
	}
	print join($FS, @Output).$/;
}


# display selected data fields
while($line = <STDIN>)
{
	chomp $line;
	
	@Input = split $FS, $line;
	@Output = ();
	
	for my $col (@Columns)
	{
		push @Output, defined $Header{$col} ? $Input[$Header{$col}] : '';
	}
	
	print join($FS, @Output).$/;
}
